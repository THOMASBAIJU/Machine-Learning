import pandas as pd
from matplotlib import pyplot as plt
from sklearn.metrics import confusion_matrix, accuracy_score
from sklearn.model_selection import train_test_split
from sklearn.cluster import KMeans
from sklearn.metrics import silhouette_score

df = pd.read_csv("https://raw.githubusercontent.com/jiss-sngce/CO_3/main/jkcars.csv")
print(df.head())
print(df.shape)
print()
print(df.info())
new_data = df[['Volume', 'Weight', 'CO2']]
print(new_data.head(5))

sil_scores = []
for k in range(2, 11):
    kmeans = KMeans(n_clusters=k, random_state=10, n_init=10)
    kmeans.fit(new_data)
    score = silhouette_score(new_data, kmeans.labels_)
    sil_scores.append(score)
silhouette_df = pd.DataFrame({'K': range(2, 11), 'Silhouette Score': sil_scores})
print(silhouette_df)

plt.figure(figsize=(9, 5))
plt.plot(silhouette_df['K'], silhouette_df['Silhouette Score'], marker='o')
plt.title('Silhouette Score vs Number of Clusters')
plt.xlabel('Number of Clusters (K)')
plt.ylabel('Silhouette Score')
plt.grid(True)
plt.show()

k_means = KMeans(n_clusters=3, random_state=10)

k_means.fit(new_data)

clusters = pd.Series(k_means.predict(new_data))

df['cluster'] = clusters
print(df.head())
